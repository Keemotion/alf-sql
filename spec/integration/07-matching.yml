# matching with no attribute
- query: |-
    matching(suppliers, project(supplies, [:qty]))
  sql:
    SELECT t1.sid, t1.name, t1.status, t1.city
      FROM suppliers AS t1
      WHERE EXISTS(SELECT * FROM supplies AS t2)
# matching on one single attribute
- query: |-
    matching(suppliers, supplies)
  sql:
    SELECT t1.sid, t1.name, t1.status, t1.city
      FROM suppliers AS t1
      WHERE t1.sid IN (SELECT t2.sid FROM supplies AS t2)
# matching on multiple attributes
- query: |-
    matching(suppliers, parts)
  sql:
    SELECT t1.sid, t1.name, t1.status, t1.city
      FROM suppliers AS t1
      WHERE EXISTS(
        SELECT t2.name, t2.city
          FROM parts AS t2
         WHERE t1.name = t2.name
           AND t1.city = t2.city)
# matching when a with_exp at right
- query: |-
    matching(suppliers, sort(sort(suppliers, [:sid, :asc]), [:sid, :desc]))
  sql:
    WITH t3 AS (
      SELECT t2.sid, t2.name, t2.status, t2.city
        FROM suppliers AS t2
       ORDER BY t2.sid ASC
    )
    SELECT t1.sid, t1.name, t1.status, t1.city
      FROM suppliers AS t1
      WHERE EXISTS(
        SELECT t3.sid, t3.name, t3.status, t3.city
        FROM t3 AS t3
        WHERE t1.sid = t3.sid
          AND t1.name = t3.name
          AND t1.status = t3.status
          AND t1.city = t3.city
        ORDER BY t3.sid DESC)
