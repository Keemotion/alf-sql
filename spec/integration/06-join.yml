# cross join
- query: |-
    join(project(suppliers, [:sid]), project(parts, [:pid]))
  sql:
    SELECT t1.sid, t2.pid
      FROM suppliers AS t1, parts AS t2
# inner join
- query: |-
    join(suppliers, supplies)
  sql:
    SELECT t1.sid, t1.name, t1.status, t1.city, t2.pid, t2.qty
      FROM suppliers AS t1
      JOIN supplies  AS t2 ON t1.sid = t2.sid
# inner join requiring keeping a common distinct
- query: |-
    join(project(suppliers, [:city]), project(parts, [:city]))
  sql:
    SELECT DISTINCT t1.city
      FROM suppliers AS t1
      JOIN parts AS t2 ON t1.city = t2.city
# inner join requiring keeping the left distinct
- query: |-
    join(project(suppliers, [:city]), parts)
  sql:
    SELECT DISTINCT t1.city, t2.pid, t2.name, t2.color, t2.weight
      FROM suppliers AS t1
      JOIN parts AS t2 ON t1.city = t2.city
# inner join requiring keeping the right distinct
- query: |-
    join(suppliers, project(parts, [:city]))
  sql:
    SELECT DISTINCT t1.sid, t1.name, t1.status, t1.city
      FROM suppliers AS t1
      JOIN parts AS t2 ON t1.city = t2.city
# inner join requiring renamings
- query: |-
    join(rename(suppliers, sid: :id), rename(supplies, sid: :id))
  sql:
    SELECT t1.sid AS id, t1.name, t1.status, t1.city, t2.pid, t2.qty
      FROM suppliers AS t1
      JOIN supplies  AS t2 ON t1.sid = t2.sid
# triple join
- query: |-
    join(join(suppliers, supplies), project(parts, [:pid, :color]))
  sql:
    SELECT t1.sid, t1.name, t1.status, t1.city, t2.pid, t2.qty, t3.color
      FROM suppliers AS t1
      JOIN supplies  AS t2 ON t1.sid = t2.sid
      JOIN parts     AS t3 ON t2.pid = t3.pid
# join with a where clause at left
- query: |-
    join(restrict(suppliers, sid: 'S2'), supplies)
  sql:
    SELECT t1.sid, t1.name, t1.status, t1.city, t2.pid, t2.qty
      FROM suppliers AS t1
      JOIN supplies  AS t2 ON t1.sid = t2.sid
     WHERE t1.sid = 'S2'
# join with a where clause at right
- query: |-
    join(suppliers, restrict(supplies, sid: 'S2'))
  sql:
    SELECT t1.sid, t1.name, t1.status, t1.city, t2.pid, t2.qty
      FROM suppliers AS t1
      JOIN supplies  AS t2 ON t1.sid = t2.sid
     WHERE t2.sid = 'S2'
# join with where clauses both sides
- query: |-
    join(restrict(suppliers, sid: 'S2'), restrict(supplies, qty: 300))
  sql:
    SELECT t1.sid, t1.name, t1.status, t1.city, t2.pid, t2.qty
      FROM suppliers AS t1
      JOIN supplies  AS t2 ON t1.sid = t2.sid
     WHERE t1.sid = 'S2'
       AND t2.qty = 300
# join with an order-by clause at left
- query: |-
    join(sort(suppliers, [:sid, :asc]), supplies)
  sql:
    SELECT t1.sid, t1.name, t1.status, t1.city, t2.pid, t2.qty
      FROM suppliers AS t1
      JOIN supplies  AS t2 ON t1.sid = t2.sid
     ORDER BY t1.sid ASC
# join with an order-by clause at right
- query: |-
    join(suppliers, sort(supplies, [:qty, :asc]))
  sql:
    SELECT t1.sid, t1.name, t1.status, t1.city, t2.pid, t2.qty
      FROM suppliers AS t1
      JOIN supplies  AS t2 ON t1.sid = t2.sid
     ORDER BY t2.qty ASC
# join with an order-by clause on both sides
- query: |-
    join(sort(suppliers, [:sid, :asc]), sort(supplies, [:qty, :asc]))
  sql:
    SELECT t1.sid, t1.name, t1.status, t1.city, t2.pid, t2.qty
      FROM suppliers AS t1
      JOIN supplies  AS t2 ON t1.sid = t2.sid
     ORDER BY t1.sid ASC, t2.qty ASC
# join with a limit/offset clause at left
- query: |-
    join(frame(suppliers, [:sid, :asc], 5, 10), supplies)
  sql:
    WITH t3 AS (
      SELECT t1.sid, t1.name, t1.status, t1.city
        FROM suppliers AS t1
        ORDER BY t1.sid ASC
        LIMIT 10 OFFSET 5
    )
    SELECT t3.sid, t3.name, t3.status, t3.city, t2.pid, t2.qty
      FROM t3 AS t3
      JOIN supplies AS t2 ON t3.sid = t2.sid
# join with a limit/offset clause at right
- query: |-
    join(suppliers, frame(supplies, [[:sid, :asc], [:pid, :asc]], 5, 10))
  sql:
    WITH t3 AS (
      SELECT t2.sid, t2.pid, t2.qty
        FROM supplies AS t2
        ORDER BY t2.sid ASC, t2.pid ASC
        LIMIT 10 OFFSET 5
    )
    SELECT t1.sid, t1.name, t1.status, t1.city, t3.pid, t3.qty
      FROM suppliers AS t1
      JOIN t3 AS t3 ON t1.sid = t3.sid
# join with a limit/offset clause on both sides
- query: |-
    join(frame(suppliers, [:sid, :asc], 5, 10),
         frame(supplies, [[:sid, :asc], [:pid, :asc]], 5, 10))
  sql:
    WITH t3 AS (SELECT t1.sid, t1.name, t1.status, t1.city
                  FROM suppliers AS t1
                 ORDER BY t1.sid ASC
                 LIMIT 10 OFFSET 5),
         t4 AS (SELECT t2.sid, t2.pid, t2.qty
                  FROM supplies AS t2
                 ORDER BY t2.sid ASC, t2.pid ASC
                 LIMIT 10 OFFSET 5)
    SELECT t3.sid, t3.name, t3.status, t3.city, t4.pid, t4.qty
      FROM t3 AS t3
      JOIN t4 AS t4 ON t3.sid = t4.sid
# join on a union at left
- query: |-
    join(union(suppliers, suppliers_2), supplies)
  sql:
    WITH t4 AS (
      (SELECT t1.sid, t1.name, t1.status, t1.city
        FROM suppliers AS t1)
      UNION
      (SELECT t2.sid, t2.name, t2.status, t2.city
        FROM suppliers AS t2)
    )
    SELECT t4.sid, t4.name, t4.status, t4.city, t3.pid, t3.qty
      FROM t4 AS t4
      JOIN supplies AS t3 ON t4.sid = t3.sid
# join on a union at right
- query: |-
    join(supplies, union(suppliers, suppliers_2))
  sql:
    WITH t4 AS (
      (SELECT t2.sid, t2.name, t2.status, t2.city
        FROM suppliers AS t2)
      UNION
      (SELECT t3.sid, t3.name, t3.status, t3.city
        FROM suppliers AS t3)
    )
    SELECT t1.sid, t1.pid, t1.qty, t4.name, t4.status, t4.city
      FROM supplies AS t1 
      JOIN t4 AS t4 ON t1.sid = t4.sid
